)]}'
{"version":3,"sources":["meteor://ðŸ’»app/lib/package_versions.js","meteor://ðŸ’»app/lib/client/update.js","meteor://ðŸ’»app/packages/telescope_update-prompt/lib/client/templates/template.update_banner.js","meteor://ðŸ’»app/lib/client/templates/update_banner.js"],"names":[],"mappings":"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","file":"/packages/telescope_update-prompt.js","sourcesContent":["Meteor.methods({\n  getPackageVersions: function () {\n    if (Meteor.isServer) {\n      var url = \"https://atmospherejs.com/a/packages/findByNames\";\n      var packageNames = _.filter(_.keys(Package), function (packageName){\n        return packageName.indexOf(\"telescope\") !== -1;\n      });\n      this.unblock;\n      try {\n        var result = HTTP.get(url, {\n          headers: {\n            \"Accept\": \"application/json\"\n          },\n          params: {\n            names: packageNames\n          }\n        });\n        // console.log(result);\n        var packageData = JSON.parse(result.content);\n        var versionData = packageData.map(function (package){\n          return {\n            name: package.name,\n            latestVersion: package.latestVersion.version,\n            currentVersion: MeteorFilesHelpers.getPackageVersion(package.name)\n          };\n        });\n        console.log(versionData);\n        return versionData;\n      } catch (e) {\n        console.log(e)\n        return e;\n      }\n    }\n  }\n});\n","compareVersions = function (v1, v2) { // return true if v2 is newer than v1\n  var v1Array = v1.split('.');\n  var v2Array = v2.split('.');\n  var isGreater = false;\n  // go through each segment of v2 and stop if we find one that's higher\n  // than the equivalent segment of v1; else return false\n  v2Array.some( function (value, index) {\n    if (parseInt(value) > parseInt(v1Array[index])) {\n      // v2 segment > v1 segment\n      isGreater = true;\n      return true; // stop comparison\n    } else if (parseInt(value) < parseInt(v1Array[index])) {\n      // v2 segment < v1 segment\n      isGreater = false;\n      return true; // stop comparison\n    }\n    return false; // continue comparison as long as both values are equal\n  });\n  return isGreater;\n};\n\nMeteor.startup(function () {\n  Session.set('updateVersion', null);\n\n  Meteor.call('phoneHome', function (error, result) {\n    // console.log(error)\n    // console.log(result)\n    if(result){\n      var currentVersion = Telescope.VERSION;\n      var newVersion = result.content;\n      if (compareVersions(currentVersion, newVersion)){\n        Session.set('updateVersion', newVersion);\n      }\n    }\n  });\n});\n\nTelescope.modules.add(\"hero\", {\n  template: 'update_banner'\n});\n","\nTemplate.__checkName(\"update_banner\");\nTemplate[\"update_banner\"] = new Template(\"Template.update_banner\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"showBanner\"));\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      \"class\": \"content-wrapper\"\n    }, \"\\n      \", HTML.DIV({\n      \"class\": \"update-banner grid-module grid banner\"\n    }, \"\\n        \", HTML.H3({\n      \"class\": \"update-version\"\n    }, Blaze.View(\"lookup:version\", function() {\n      return Spacebars.mustache(view.lookup(\"version\"));\n    })), \"\\n        \", HTML.DIV({\n      \"class\": \"update-content\"\n    }, \"\\n          \", HTML.H4({\n      \"class\": \"update-prompt\"\n    }, \"A new version of Telescope is available.\"), \"\\n          \", HTML.P({\n      \"class\": \"update-message\"\n    }, \"\\n            You have: \", Blaze.View(\"lookup:currentVersion\", function() {\n      return Spacebars.mustache(view.lookup(\"currentVersion\"));\n    }), \". Note: this message is only displayed to admins.\\n            \", HTML.A({\n      href: \"https://github.com/TelescopeJS/Telescope/blob/master/History.md\",\n      target: \"_blank\"\n    }, \"Learn more\"), \"\\n            \"), \"\\n        \"), \"\\n      \"), \"\\n    \"), \"\\n  \" ];\n  });\n}));\n","Template.update_banner.helpers({\n  showBanner: function () {\n    return Session.get('updateVersion');\n  },\n  version: function () {\n    return Session.get('updateVersion');\n  },\n  currentVersion: function () {\n    return Telescope.VERSION;\n  },\n  message: function () {\n    return Session.get('updateMessage');\n  }\n});\n"]}