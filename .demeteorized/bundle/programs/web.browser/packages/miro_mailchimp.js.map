)]}'
{"version":3,"sources":["meteor://ðŸ’»app/packages/miro_mailchimp/packages/miro_mailchimp.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kH","file":"/packages/miro_mailchimp.js","sourcesContent":["(function () {\n\n///////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                   //\n// packages/miro:mailchimp/lib/client/mailchimp.js                                                   //\n//                                                                                                   //\n///////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                     //\nvar subscribeMessage\t\t\t= 'Get on the mailing list:',                                                 // 1\n\tsubscribeInvalidEmail\t\t= 'Invalid email address :(',                                                // 2\n\tsubscribeSubscribing\t\t= 'Subscribing...',                                                           // 3\n\tsubscribeSuccess\t\t\t= 'Oh joy! Check your inbox! :)',                                                // 4\n\tsubscribeAlreadySubscribed\t= 'Already subscribed! O.o',                                             // 5\n                                                                                                     // 6\n\tsubscribeTitle,                                                                                     // 7\n\tsubscribeEmail,                                                                                     // 8\n\tsubscribeButton,                                                                                    // 9\n                                                                                                     // 10\n\tshowMessage = function ( message ) {                                                                // 11\n\t\tif ( subscribeTitle ) {                                                                            // 12\n\t\t\tsubscribeTitle.innerHTML = message;                                                               // 13\n\t\t}                                                                                                  // 14\n\t},                                                                                                  // 15\n                                                                                                     // 16\n\tisValidEmailAddress = function ( emailAddress ) {                                                   // 17\n\t\t// http://stackoverflow.com/a/46181/11236                                                          // 18\n\t\tvar re = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                                                                                                     // 20\n\t\treturn re.test( emailAddress );                                                                    // 21\n\t},                                                                                                  // 22\n                                                                                                     // 23\n\tvalidateEmailAddress = function ( updateMessage ) {                                                 // 24\n\t\tif ( subscribeEmail.value !== '' && isValidEmailAddress( subscribeEmail.value ) ) {                // 25\n\t\t\tsubscribeButton.disabled = false;                                                                 // 26\n                                                                                                     // 27\n\t\t\tif ( updateMessage ) {                                                                            // 28\n\t\t\t\tshowMessage( subscribeMessage );                                                                 // 29\n\t\t\t}                                                                                                 // 30\n\t\t} else {                                                                                           // 31\n\t\t\tsubscribeButton.disabled = true;                                                                  // 32\n                                                                                                     // 33\n\t\t\tif ( subscribeEmail.value !== '' ) {                                                              // 34\n\t\t\t\tshowMessage( subscribeInvalidEmail );                                                            // 35\n\t\t\t} else if ( updateMessage ) {                                                                     // 36\n\t\t\t\tshowMessage( subscribeMessage );                                                                 // 37\n\t\t\t}                                                                                                 // 38\n\t\t}                                                                                                  // 39\n\t},                                                                                                  // 40\n                                                                                                     // 41\n\tmailChimpListSubscribe = function ( email, listId ) {                                               // 42\n\t\tvar mailChimp = new MailChimp( /* apiKey, options */ );                                            // 43\n                                                                                                     // 44\n\t\tmailChimp.call( 'lists', 'subscribe',                                                              // 45\n\t\t\t{                                                                                                 // 46\n\t\t\t\tid   : listId,\t\t// null -> defined @ server                                                      // 47\n\t\t\t\temail: {                                                                                         // 48\n\t\t\t\t\temail: email                                                                                    // 49\n\t\t\t\t}                                                                                                // 50\n\t\t\t},                                                                                                // 51\n                                                                                                     // 52\n\t\t\tfunction ( error, result ) {                                                                      // 53\n\t\t\t\tif ( error ) {                                                                                   // 54\n\t\t\t\t\tswitch ( error.error ) {                                                                        // 55\n\t\t\t\t\t\tcase 232:\t// 'Email_NotExists'                                                                 // 56\n\t\t\t\t\t\t\tshowMessage( subscribeInvalidEmail );                                                         // 57\n\t\t\t\t\t\t\tbreak;                                                                                        // 58\n                                                                                                     // 59\n\t\t\t\t\t\tcase 214:\t// 'List_AlreadySubscribed'                                                          // 60\n\t\t\t\t\t\t\tshowMessage( subscribeAlreadySubscribed );                                                    // 61\n\t\t\t\t\t\t\tbreak;                                                                                        // 62\n                                                                                                     // 63\n\t\t\t\t\t\tcase 200:\t// 'List_DoesNotExist'                                                               // 64\n\t\t\t\t\t\t\t// We shouldn't be here!                                                                      // 65\n\t\t\t\t\t\t\t// Oh, well, continue to default...                                                           // 66\n\t\t\t\t\t\tdefault:                                                                                       // 67\n\t\t\t\t\t\t\tshowMessage( 'Error: ' + error.reason );                                                      // 68\n\t\t\t\t\t}                                                                                               // 69\n                                                                                                     // 70\n\t\t\t\t\tconsole.error( '[MailChimp][Subscribe] Error: %o', error );                                     // 71\n                                                                                                     // 72\n\t\t\t\t} else {                                                                                         // 73\n                                                                                                     // 74\n\t\t\t\t\tconsole.info( '[MailChimp][Subscribe] Yo, ' + subscribeEmail.value + ', ' + subscribeSuccess ); // 75\n\t\t\t\t\tconsole.info( '[MailChimp][Subscribe] Subscriber: %o', result );                                // 76\n                                                                                                     // 77\n\t\t\t\t\tshowMessage( subscribeSuccess );                                                                // 78\n\t\t\t\t}                                                                                                // 79\n                                                                                                     // 80\n\t\t\t\tsubscribeEmail.disabled = false;                                                                 // 81\n\t\t\t\tvalidateEmailAddress( false );                                                                   // 82\n\t\t\t}                                                                                                 // 83\n\t\t);                                                                                                 // 84\n\t},                                                                                                  // 85\n                                                                                                     // 86\n\tsubscribeGo = function ( eventBubbling ) {                                                          // 87\n\t\tsubscribeEmail.disabled  = true;                                                                   // 88\n\t\tsubscribeButton.disabled = true;                                                                   // 89\n                                                                                                     // 90\n\t\tshowMessage( subscribeSubscribing );                                                               // 91\n                                                                                                     // 92\n\t\tmailChimpListSubscribe( subscribeEmail.value );                                                    // 93\n                                                                                                     // 94\n\t\t// Prevent Event Bubbling                                                                          // 95\n\t\treturn eventBubbling;                                                                              // 96\n\t};                                                                                                  // 97\n                                                                                                     // 98\nMailChimp = function ( apiKey, options ) {                                                           // 99\n\tthis._options = {                                                                                   // 100\n\t\tapiKey : ( apiKey ) ? apiKey : Session.get( 'MailChimp.apiKey' ),                                  // 101\n\t\toptions: options                                                                                   // 102\n\t};                                                                                                  // 103\n};                                                                                                   // 104\n                                                                                                     // 105\nMailChimp.prototype.call = function ( section, method, options, callback ) {                         // 106\n\tvar mailChimpOptions = _.defaults( {}, options );                                                   // 107\n                                                                                                     // 108\n\tswitch ( section ) {                                                                                // 109\n\t\tcase 'lists':                                                                                      // 110\n\t\t\tif ( !mailChimpOptions.id || mailChimpOptions.id === '' ) {                                       // 111\n\t\t\t\tmailChimpOptions.id = Session.get( 'MailChimp.lists.listId' );                                   // 112\n\t\t\t}                                                                                                 // 113\n                                                                                                     // 114\n\t\t\tbreak;                                                                                            // 115\n\t\tdefault:                                                                                           // 116\n\t}                                                                                                   // 117\n                                                                                                     // 118\n\tMeteor.call( 'MailChimp',                                                                           // 119\n\t\tthis._options,                                                                                     // 120\n\t\tsection,                                                                                           // 121\n\t\tmethod,                                                                                            // 122\n\t\tmailChimpOptions,                                                                                  // 123\n\t\tcallback                                                                                           // 124\n\t);                                                                                                  // 125\n};                                                                                                   // 126\n                                                                                                     // 127\nMeteor.startup( function () {                                                                        // 128\n\tif ( Blaze.isTemplate( Template[ 'MailChimpListSubscribe' ] ) ) {                                   // 129\n\t\tTemplate.MailChimpListSubscribe.rendered = function () {                                           // 130\n\t\t\tsubscribeTitle  = this.find( '.mailchimp-message' );                                              // 131\n\t\t\tsubscribeEmail  = this.find( '.mailchimp-email' );                                                // 132\n\t\t\tsubscribeButton = this.find( '.mailchimp-subscribe' );                                            // 133\n\t\t\tsubscribeButton.disabled = ( subscribeEmail.value === '' );                                       // 134\n\t\t};                                                                                                 // 135\n                                                                                                     // 136\n\t\tTemplate.MailChimpListSubscribe.helpers({                                                          // 137\n\t\t\tmessage: function () {                                                                            // 138\n\t\t\t\tsubscribeMessage = this.title || subscribeMessage;                                               // 139\n                                                                                                     // 140\n\t\t\t\treturn subscribeMessage;                                                                         // 141\n\t\t\t}                                                                                                 // 142\n\t\t});                                                                                                // 143\n                                                                                                     // 144\n\t\tTemplate.MailChimpListSubscribe.events({                                                           // 145\n\t\t\t'focus .mailchimp-email, paste .mailchimp-email, cut .mailchimp-email': function ( e ) {          // 146\n\t\t\t\tMeteor.setTimeout( function ( e ) {                                                              // 147\n\t\t\t\t\tvalidateEmailAddress( true );                                                                   // 148\n\t\t\t\t}, 0 );                                                                                          // 149\n\t\t\t},                                                                                                // 150\n                                                                                                     // 151\n\t\t\t'keyup .mailchimp-email': function ( e ) {                                                        // 152\n\t\t\t\tvar key = e.which || e.keyCode || e.charCode;                                                    // 153\n                                                                                                     // 154\n\t\t\t\tif (                                                                                             // 155\n\t\t\t\t\tkey === 8 ||\t\t\t\t// [Backspace]                                                                  // 156\n\t\t\t\t\tkey === 46\t\t\t\t\t// [Delete]                                                                      // 157\n\t\t\t\t) {                                                                                              // 158\n\t\t\t\t\tMeteor.setTimeout( function () {                                                                // 159\n\t\t\t\t\t\tvalidateEmailAddress( true );                                                                  // 160\n\t\t\t\t\t}, 0 );                                                                                         // 161\n\t\t\t\t}                                                                                                // 162\n\t\t\t},                                                                                                // 163\n                                                                                                     // 164\n\t\t\t'keypress .mailchimp-email': function ( e ) {                                                     // 165\n\t\t\t\tvar key = e.which || e.keyCode || e.charCode;                                                    // 166\n                                                                                                     // 167\n\t\t\t\tMeteor.setTimeout( function () {                                                                 // 168\n\t\t\t\t\tvalidateEmailAddress( true );                                                                   // 169\n                                                                                                     // 170\n\t\t\t\t\tif ( isValidEmailAddress( subscribeEmail.value  ) ) {                                           // 171\n\t\t\t\t\t\tif ( key === 13\t) {\t\t// [Return]                                                               // 172\n\t\t\t\t\t\t\tsubscribeGo( true );                                                                          // 173\n\t\t\t\t\t\t}                                                                                              // 174\n\t\t\t\t\t}                                                                                               // 175\n\t\t\t\t}, 0 );                                                                                          // 176\n\t\t\t},                                                                                                // 177\n                                                                                                     // 178\n\t\t\t'click .mailchimp-subscribe': function ( e ) {                                                    // 179\n\t\t\t\tvalidateEmailAddress( true );                                                                    // 180\n                                                                                                     // 181\n\t\t\t\tif ( isValidEmailAddress( subscribeEmail.value  ) ) {                                            // 182\n\t\t\t\t\tsubscribeGo( false );                                                                           // 183\n\t\t\t\t}                                                                                                // 184\n\t\t\t}                                                                                                 // 185\n\t\t});                                                                                                // 186\n\t}                                                                                                   // 187\n});                                                                                                  // 188\n                                                                                                     // 189\n///////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n"]}