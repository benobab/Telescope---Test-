)]}'
{"version":3,"sources":["meteor://ðŸ’»app/lib/events.js","meteor://ðŸ’»app/lib/client/analytics.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAM,GAAG,IAAI,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;;AAExC,MAAM,CAAC,MAAM,GAAG,IAAI,YAAY,CAAC;AAC/B,WAAS,EAAE;AACT,QAAI,EAAE,IAAI;GACX;AACD,MAAI,EAAE;AACJ,QAAI,EAAE,MAAM;GACb;AACD,aAAW,EAAE;AACX,QAAI,EAAE,MAAM;AACZ,YAAQ,EAAE,IAAI;GACf;AACD,QAAM,EAAE;AACN,QAAI,EAAE,OAAO;AACb,YAAQ,EAAE,IAAI;GACf;AACD,WAAS,EAAE;AACT,QAAI,EAAE,OAAO;AACb,YAAQ,EAAE,IAAI;GACf;AACD,YAAU,EAAE;AACV,QAAI,EAAE,MAAM;AACZ,YAAQ,EAAE,IAAI;AACd,YAAQ,EAAE,IAAI;GACf;CACF,CAAC,CAAC;;AAEH,MAAM,CAAC,OAAO,CAAC,YAAU;;AAEvB,QAAM,CAAC,gBAAgB,EAAE,CAAC;CAC3B,CAAC,CAAC;;AAEH,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;;AAEnC,IAAI,MAAM,CAAC,QAAQ,EAAE;AACnB,QAAM,CAAC,GAAG,GAAG,UAAU,KAAK,EAAE;;;AAG5B,QAAI,CAAC,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,EAAC,IAAI,EAAE,KAAK,CAAC,IAAI,EAAC,CAAC,EAAE;AAC1D,aAAO;KACR;;AAED,SAAK,CAAC,SAAS,GAAG,IAAI,IAAI,EAAE,CAAC;;AAE7B,UAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;GAEtB,CAAC;CACH;;AAED,MAAM,CAAC,KAAK,GAAG,UAAS,KAAK,EAAE,UAAU,EAAC;;AAExC,YAAU,GAAG,UAAU,IAAI,EAAE,CAAC;;;AAG9B,MAAG,MAAM,CAAC,QAAQ,EAAC;AACjB,QAAG,OAAO,QAAQ,KAAK,WAAW,IAAI,OAAO,QAAQ,CAAC,KAAK,KAAK,WAAW,EAAC;AAC1E,cAAQ,CAAC,KAAK,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;KACnC;AACD,QAAG,OAAO,SAAS,KAAK,WAAW,IAAI,OAAO,SAAS,CAAC,cAAc,KAAK,WAAW,EAAC;AACrF,eAAS,CAAC,cAAc,CAAC,UAAU,CAAC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC;KACxE;GACF;CACF,CAAC,oH;;;;;;;;;;;;;;;;;;AC/DF,MAAM,CAAC,aAAa,GAAG,YAAW;;;AAGhC,MAAI,UAAU,GAAC,QAAQ,CAAC,GAAG,CAAC,YAAY,CAAC,EAAC;AACxC,KAAC,UAAU,CAAC,EAAE,CAAC,EAAE;AACjB,YAAM,CAAC,QAAQ,GAAG,CAAC,CAAC;AACpB,UAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;AACf,OAAC,GAAG,CAAC,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AAC9B,OAAC,CAAC,IAAI,GAAG,iBAAiB,CAAC;AAC3B,OAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;AACb,OAAC,CAAC,GAAG,GAAG,CAAC,QAAQ,KAAK,CAAC,CAAC,QAAQ,CAAC,QAAQ,GAAG,QAAQ,GAAG,OAAO,IAAI,0CAA0C,CAAC;AAC7G,OAAC,GAAG,CAAC,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;AACxC,OAAC,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAChC,OAAC,CAAC,EAAE,GAAG,EAAE,CAAC;AACV,OAAC,CAAC,IAAI,GAAG,UAAU,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE;AACxB,iBAAS,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE;AACb,cAAI,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;AACrB,WAAC,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACzC,WAAC,CAAC,CAAC,CAAC,GAAG,YAAY;AACf,aAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;WAChE,CAAC;SACL;AACD,YAAI,CAAC,GAAG,CAAC,CAAC;AACV,mBAAW,KAAK,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,UAAU,CAAC;AAC1D,SAAC,CAAC,MAAM,GAAG,CAAC,CAAC,MAAM,IAAI,EAAE,CAAC;AAC1B,SAAC,GAAG,iKAAiK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;AACjL,aAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AAC1C,SAAC,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;OACxB,CAAC;AACF,OAAC,CAAC,IAAI,GAAG,GAAG,CAAC;KACZ,EAAE,QAAQ,EAAE,MAAM,CAAC,QAAQ,IAAI,EAAE,CAAC,CAAC;AACpC,YAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;GAC3B;;;AAGD,MAAI,WAAW,GAAG,QAAQ,CAAC,GAAG,CAAC,aAAa,CAAC,EAAE;AAC7C,UAAM,CAAC,SAAS,GAAG,EAAE,CAAC;AACtB,aAAS,CAAC,IAAI,GAAG,WAAW,CAAC;AAC7B,UAAM,CAAC,QAAQ,GAAG,CAAC,IAAI,IAAI,EAAE,CAAC;AAC9B,QAAI,CAAC,GAAG,QAAQ;QAAE,CAAC,GAAG,CAAC,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AAChD,KAAC,CAAC,IAAI,GAAG,iBAAiB,CAAC;AAC3B,KAAC,CAAC,GAAG,GAAG,4CAA4C,CAAC;AACrD,QAAI,CAAC,GAAG,CAAC,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;AAC5C,KAAC,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;GACjC;;;AAGD,MAAK,QAAQ,GAAG,QAAQ,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;AACxC,mBAAe,GAAG,EAAE,CAAC;AACrB,mBAAe,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;AAC/B,KAAC,YAAW;AACV,UAAI,CAAC,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AACzC,OAAC,CAAC,IAAI,GAAG,iBAAiB,CAAC;AAC3B,OAAC,CAAC,KAAK,GAAG,IAAI,CAAC;AACf,OAAC,CAAC,GAAG,GAAG,2BAA2B,CAAC;AACpC,OAAE,QAAQ,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,QAAQ,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAG,WAAW,CAAE,CAAC,CAAE,CAAC;KAC3G,GAAG,CAAC;GACN;;;AAGD,MAAI,iBAAiB,GAAG,QAAQ,CAAC,GAAG,CAAC,mBAAmB,CAAC,EAAC;;AAExD,KAAC,UAAS,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC;AAAC,OAAC,CAAC,uBAAuB,CAAC,GAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAC,CAAC,CAAC,CAAC,CAAC,IAAE,YAAU;AAC3E,SAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAE,EAAE,EAAE,IAAI,CAAC,SAAS,CAAC;OAAC,EAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAC,CAAC,GAAC,IAAI,IAAI,EAAE,CAAC,CAAC,GAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,EAC7E,CAAC,GAAC,CAAC,CAAC,oBAAoB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,GAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAC,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC,EAAC,CAAC,CAAC;KAC9E,EAAE,MAAM,EAAC,QAAQ,EAAC,QAAQ,EAAC,yCAAyC,EAAC,IAAI,CAAC,CAAC;;AAE5E,QAAI,YAAY,GAAG,QAAQ,CAAC,MAAM,KAAK,WAAW,GAAG,MAAM,GAAG,MAAM,CAAC;;AAErE,UAAM,CAAC,EAAE,CAAC,QAAQ,EAAE,iBAAiB,EAAE,YAAY,CAAC,CAAC;GAEtD;;;AAGD,QAAM,CAAC,gBAAgB,EAAE,CAAC;CAE3B,CAAC;;AAEF,MAAM,CAAC,gBAAgB,GAAG,YAAW;;;AAGnC,MAAI,OAAO,MAAM,CAAC,EAAE,KAAK,WAAW,EAAC;AACnC,UAAM,CAAC,EAAE,CAAC,MAAM,EAAE,UAAU,EAAE;AAC5B,YAAM,EAAE,UAAU,CAAC,OAAO,EAAE,CAAC,IAAI;KAClC,CAAC,CAAC;GACJ;;;AAGD,MAAG,OAAO,QAAQ,KAAK,WAAW,IAAI,OAAO,QAAQ,CAAC,MAAM,KAAK,WAAW,EAAC;AAC3E,QAAG,MAAM,CAAC,IAAI,EAAE,EAAC;AACf,UAAI,gBAAgB,GAAG,KAAK,CAAC,mBAAmB,EAAE,CAAC;AACnD,cAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;AAC3C,cAAQ,CAAC,MAAM,CAAC,GAAG,CAAC;AAChB,kBAAU,EAAE,KAAK,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;AAC/C,qBAAa,EAAE,IAAI,IAAI,EAAE;AACzB,kBAAU,EAAE,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC,SAAS,CAAC,CAAC,EAAE;AAC9C,gBAAQ,EAAE,gBAAgB;OAC7B,CAAC,CAAC;AACH,cAAQ,CAAC,QAAQ,CAAC;AACd,kBAAU,EAAE,KAAK,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;AAC/C,mBAAW,EAAE,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC,SAAS,CAAC,CAAC,EAAE;AAC/C,eAAO,EAAE,gBAAgB;OAC5B,CAAC,CAAC;AACH,cAAQ,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;KACrC;GACF;;;AAGD,MAAI,OAAO,SAAS,KAAK,WAAW,IAAI,OAAO,SAAS,CAAC,cAAc,KAAK,WAAW,EAAE;AACvF,aAAS,CAAC,cAAc,CAAC,SAAS,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC,IAAI,EAAE,UAAU,CAAC,OAAO,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;GAChG;;;AAGD,MAAG,OAAO,MAAM,KAAK,WAAW,EAAC;AAC/B,UAAM,CAAC,GAAG,CAAC,kBAAkB,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,EAAE,UAAU,CAAC,OAAO,EAAE,CAAC,KAAK,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;GACxG;CAEF,CAAC,oH","file":"/packages/telescope_events.js","sourcesContent":["Events = new Mongo.Collection('events');\n\nEvents.schema = new SimpleSchema({\n  createdAt: {\n    type: Date\n  },\n  name: {\n    type: String\n  },\n  description: {\n    type: String,\n    optional: true\n  },\n  unique: {\n    type: Boolean,\n    optional: true\n  },\n  important: { // marking an event as important means it should never be erased\n    type: Boolean,\n    optional: true\n  },\n  properties: {\n    type: Object,\n    optional: true,\n    blackbox: true\n  }\n});\n\nMeteor.startup(function(){\n  // needs to happen after every fields are added\n  Events.internationalize();\n});\n\nEvents.attachSchema(Events.schema);\n\nif (Meteor.isServer) {\n  Events.log = function (event) {\n\n    // if event is supposed to be unique, check if it has already been logged\n    if (!!event.unique && !!Events.findOne({name: event.name})) {\n      return;\n    }\n\n    event.createdAt = new Date();\n\n    Events.insert(event);\n\n  };\n}\n\nEvents.track = function(event, properties){\n  // console.log('trackevent: ', event, properties);\n  properties = properties || {};\n  //TODO\n  // add event to an Events collection for logging and buffering purposes\n  if(Meteor.isClient){\n    if(typeof mixpanel !== 'undefined' && typeof mixpanel.track !== 'undefined'){\n      mixpanel.track(event, properties);\n    }\n    if(typeof GoSquared !== 'undefined' && typeof GoSquared.DefaultTracker !== 'undefined'){\n      GoSquared.DefaultTracker.TrackEvent(event, JSON.stringify(properties));\n    }\n  }\n};\n","Events.analyticsInit = function() {\n\n  // Mixpanel\n  if (mixpanelId=Settings.get(\"mixpanelId\")){\n    (function (c, a) {\n    window.mixpanel = a;\n    var b, d, h, e;\n    b = c.createElement(\"script\");\n    b.type = \"text/javascript\";\n    b.async = !0;\n    b.src = (\"https:\" === c.location.protocol ? \"https:\" : \"http:\") + '//cdn.mxpnl.com/libs/mixpanel-2.1.min.js';\n    d = c.getElementsByTagName(\"script\")[0];\n    d.parentNode.insertBefore(b, d);\n    a._i = [];\n    a.init = function (b, c, f) {\n        function d(a, b) {\n            var c = b.split(\".\");\n            2 == c.length && (a = a[c[0]], b = c[1]);\n            a[b] = function () {\n                a.push([b].concat(Array.prototype.slice.call(arguments, 0)));\n            };\n        }\n        var g = a;\n        \"undefined\" !== typeof f ? g = a[f] = [] : f = \"mixpanel\";\n        g.people = g.people || [];\n        h = \"disable track track_pageview track_links track_forms register register_once unregister identify name_tag set_config people.identify people.set people.increment\".split(\" \");\n        for (e = 0; e < h.length; e++) d(g, h[e]);\n        a._i.push([b, c, f]);\n    };\n    a.__SV = 1.1;\n    })(document, window.mixpanel || []);\n    mixpanel.init(mixpanelId);\n  }\n\n  // GoSquared\n  if (goSquaredId = Settings.get(\"goSquaredId\")) {\n    window.GoSquared = {};\n    GoSquared.acct = goSquaredId;\n    window._gstc_lt = +new Date();\n    var d = document, g = d.createElement(\"script\");\n    g.type = \"text/javascript\";\n    g.src = \"//d1l6p2sc9645hc.cloudfront.net/tracker.js\";\n    var s = d.getElementsByTagName(\"script\")[0];\n    s.parentNode.insertBefore(g, s);\n  }\n\n  // Clicky\n  if ((clickyId = Settings.get(\"clickyId\"))){\n    clicky_site_ids = [];\n    clicky_site_ids.push(clickyId);\n    (function() {\n      var s = document.createElement('script');\n      s.type = 'text/javascript';\n      s.async = true;\n      s.src = '//static.getclicky.com/js';\n      ( document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0] ).appendChild( s );\n    })();\n  }\n\n  // Google Analytics\n  if (googleAnalyticsId = Settings.get(\"googleAnalyticsId\")){\n\n    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n\n    var cookieDomain = document.domain === \"localhost\" ? \"none\" : \"auto\";\n\n    window.ga('create', googleAnalyticsId, cookieDomain);\n\n  }\n\n  // trigger first request once analytics are initialized\n  Events.analyticsRequest();\n\n};\n\nEvents.analyticsRequest = function() {\n\n  // Google Analytics\n  if (typeof window.ga !== 'undefined'){\n    window.ga('send', 'pageview', {\n      'page': FlowRouter.current().path\n    });\n  }\n\n  // Mixpanel\n  if(typeof mixpanel !== 'undefined' && typeof mixpanel.people !== 'undefined'){\n    if(Meteor.user()){\n      var currentUserEmail = Users.getCurrentUserEmail();\n      mixpanel.people.identify(currentUserEmail);\n      mixpanel.people.set({\n          'username': Users.getDisplayName(Meteor.user()),\n          '$last_login': new Date(),\n          '$created': moment(Meteor.user().createdAt)._d,\n          '$email': currentUserEmail\n      });\n      mixpanel.register({\n          'username': Users.getDisplayName(Meteor.user()),\n          'createdAt': moment(Meteor.user().createdAt)._d,\n          'email': currentUserEmail\n      });\n      mixpanel.name_tag(currentUserEmail);\n    }\n  }\n\n  // GoSquared\n  if (typeof GoSquared !== 'undefined' && typeof GoSquared.DefaultTracker !== 'undefined') {\n    GoSquared.DefaultTracker.TrackView(FlowRouter.current().path, FlowRouter.current().route.name);\n  }\n\n  // Clicky\n  if(typeof clicky !== 'undefined'){\n    clicky.log(encodeURIComponent(FlowRouter.current().path), FlowRouter.current().route.name, \"pageview\");\n  }\n\n};\n"]}