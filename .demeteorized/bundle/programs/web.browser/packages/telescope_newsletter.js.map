)]}'
{"version":3,"sources":["meteor://ðŸ’»app/packages/telescope_newsletter/package-i18n.js","meteor://ðŸ’»app/lib/newsletter.js","meteor://ðŸ’»app/packages/telescope_newsletter/lib/client/templates/template.newsletter_banner.js","meteor://ðŸ’»app/lib/client/templates/newsletter_banner.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/ar.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/bg.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/cs.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/da.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/de.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/el.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/en.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/es.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/et.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/fr.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/hu.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/id.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/it.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/ja.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/kk.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/ko.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/nl.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/pl.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/pt-BR.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/ro.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/ru.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/sl.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/sv.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/th.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/tr.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/vi.i18n.js","meteor://ðŸ’»app/packages/telescope_newsletter/packages/telescope_newsletteri18n/zh-CN.i18n.js"],"names":[],"mappings":"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;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2H","file":"/packages/telescope_newsletter.js","sourcesContent":["TAPi18n.packages[\"telescope:newsletter\"] = {\"translation_function_name\":\"__\",\"helper_name\":\"_\",\"namespace\":\"project\"};\n\n// define package's translation function (proxy to the i18next)\n__ = TAPi18n._getPackageI18nextProxy(\"project\");\n// define the package's templates registrar\nregisterI18nTemplate = TAPi18n._getRegisterHelpersProxy(\"telescope:newsletter\");\nregisterTemplate = registerI18nTemplate; // XXX OBSOLETE, kept for backward compatibility will be removed in the future\n\n// Record the list of templates prior to package load\nvar _ = Package.underscore._;\nnon_package_templates = _.keys(Template);\n","var campaignSchema = new SimpleSchema({\n _id: {\n    type: String,\n    optional: true\n  },\n  createdAt: {\n    type: Date,\n    optional: true\n  },\n  sentAt: {\n    type: String,\n    optional: true\n  },\n  status: {\n    type: String,\n    optional: true\n  },\n  posts: {\n    type: [String],\n    optional: true\n  },\n  webHits: {\n    type: Number,\n    optional: true\n  },\n});\n\nCampaigns = new Meteor.Collection(\"campaigns\", {\n  schema: campaignSchema\n});\n\nPosts.addField({\n  fieldName: 'scheduledAt',\n  fieldSchema: {\n    type: Date,\n    optional: true,\n    autoform: {\n      omit: true\n    }\n  }\n});\n\nUsers.addField([\n  {\n    fieldName: 'telescope.newsletter.showBanner',\n    fieldSchema: {\n      label: 'Show banner',\n      type: Boolean,\n      optional: true,\n      editableBy: ['admin', 'member'],\n      autoform: {\n        omit: true\n      }\n    }\n  },\n  {\n    fieldName: 'telescope.newsletter.subscribeToNewsletter',\n    fieldSchema: {\n      label: 'Subscribe to newsletter',\n      type: Boolean,\n      optional: true,\n      editableBy: ['admin', 'member'],\n      autoform: {\n        omit: true\n      }\n    }\n  }\n]);\n\n// Settings\n\nSettings.addField([\n  {\n    fieldName: 'enableNewsletter',\n    fieldSchema: {\n      type: Boolean,\n      optional: true,\n      autoform: {\n        group: 'newsletter',\n        instructions: 'Enable newsletter (requires restart).'\n      }\n    }\n  },\n  {\n    fieldName: 'showBanner',\n    fieldSchema: {\n      type: Boolean,\n      optional: true,\n      label: 'Newsletter banner',\n      autoform: {\n        group: 'newsletter',\n        instructions: 'Show newsletter sign-up form on the front page.'\n      }\n    }\n  },\n  {\n    fieldName: \"mailChimpAPIKey\",\n    fieldSchema: {\n      type: String,\n      optional: true,\n      private: true,\n      autoform: {\n        group: \"newsletter\",\n        class: \"private-field\"\n      }\n    }\n  },\n  {\n    fieldName: 'mailChimpListId',\n    fieldSchema: {\n      type: String,\n      optional: true,\n      private: true,\n      autoform: {\n        group: 'newsletter',\n        instructions: 'The ID of the list you want to send to.',\n        class: \"private-field\"\n      }\n    }\n  },\n  {\n    fieldName: 'postsPerNewsletter',\n    fieldSchema: {\n      type: Number,\n      optional: true,\n      autoform: {\n        group: 'newsletter'\n      }\n    }\n  },\n  {\n    fieldName: 'newsletterFrequency',\n    fieldSchema: {\n      type: [Number],\n      optional: true,\n      autoform: {\n        group: 'newsletter',\n        instructions: 'Defaults to once a week on Monday. Changes require restarting your app to take effect.',\n        noselect: true,\n        options: [\n          {\n            value: 1,\n            label: 'Sunday'\n          },\n          {\n            value: 2,\n            label: 'Monday'\n          },\n          {\n            value: 3,\n            label: 'Tuesday'\n          },\n          {\n            value: 4,\n            label: 'Wednesday'\n          },\n          {\n            value: 5,\n            label: 'Thursday'\n          },\n          {\n            value: 6,\n            label: 'Friday'\n          },\n          {\n            value: 7,\n            label: 'Saturday'\n          }\n        ]\n      }\n    }\n  },\n  {\n    fieldName: 'newsletterTime',\n    fieldSchema: {\n      type: String,\n      optional: true,\n      defaultValue: '00:00',\n      autoform: {\n        group: 'newsletter',\n        instructions: 'Defaults to 00:00/12:00 AM. Time to send out newsletter if enabled.',\n        type: 'time'\n      }\n    }\n  },\n  {\n    fieldName: 'autoSubscribe',\n    fieldSchema: {\n      type: Boolean,\n      optional: true,\n      autoform: {\n        group: 'newsletter',\n        instructions: 'Automatically subscribe new users on sign-up.'\n      }\n    }\n  }\n]);\n\n// create new \"campaign\" lens for all posts from the past X days that haven't been scheduled yet\nPosts.views.add(\"campaign\", function (terms) {\n  return {\n    find: {\n      scheduledAt: {$exists: false},\n      postedAt: {\n        $gte: terms.after\n      }\n    },\n    options: {sort: {baseScore: -1}}\n  };\n});\n\nTelescope.modules.add(\"contentTop\", {\n  template: 'newsletter_banner',\n  order: 1,\n  only: [\"postsDefault\"]\n});\n\n function subscribeUserOnProfileCompletion (user) {\n  if (!!Settings.get('autoSubscribe') && !!Users.getEmail(user)) {\n    addToMailChimpList(user, false, function (error, result) {\n      console.log(error);\n      console.log(result);\n    });\n  }\n  return user;\n}\nTelescope.callbacks.add(\"profileCompletedAsync\", subscribeUserOnProfileCompletion);\n","\nTemplate.__checkName(\"newsletter_banner\");\nTemplate[\"newsletter_banner\"] = new Template(\"Template.newsletter_banner\", (function() {\n  var view = this;\n  return HTML.DIV({\n    \"class\": \"newsletter-banner-wrapper\"\n  }, \"\\n    \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"showBanner\"));\n  }, function() {\n    return [ \"\\n      \", HTML.DIV({\n      \"class\": \"newsletter-banner banner\"\n    }, \"\\n        \", HTML.FORM(\"\\n          \", HTML.H4({\n      \"class\": \"newsletter-tagline\"\n    }, Blaze.View(\"lookup:_\", function() {\n      return Spacebars.mustache(view.lookup(\"_\"), \"receive_the_best_of\");\n    }), \" \", Blaze.View(\"lookup:siteName\", function() {\n      return Spacebars.mustache(view.lookup(\"siteName\"));\n    }), \" \", Blaze.View(\"lookup:_\", function() {\n      return Spacebars.mustache(view.lookup(\"_\"), \"right_in_your_inbox\");\n    })), \"\\n          \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"isNotConnected\"));\n    }, function() {\n      return [ \"\\n            \", HTML.INPUT({\n        \"class\": \"newsletter-email\",\n        type: \"email\",\n        placeholder: \"Your Email\"\n      }), \"\\n          \" ];\n    }), \"\\n          \", HTML.BUTTON({\n      \"class\": \"button newsletter-button btn btn-primary\"\n    }, Blaze.View(\"lookup:_\", function() {\n      return Spacebars.mustache(view.lookup(\"_\"), \"get_newsletter\");\n    }), HTML.SPAN({\n      \"class\": \"button-loader\"\n    }, HTML.IMG({\n      src: \"/packages/telescope_core/public/img/loading.svg\"\n    }))), \"\\n        \"), \"\\n        \", HTML.H4({\n      \"class\": \"newsletter-subscribed\"\n    }, Blaze.View(\"lookup:_\", function() {\n      return Spacebars.mustache(view.lookup(\"_\"), \"thanks_for_subscribing\");\n    })), \"\\n        \", HTML.A({\n      href: \"#\",\n      \"class\": \"newsletter-dismiss banner-dismiss\"\n    }, Blaze.View(\"lookup:icon\", function() {\n      return Spacebars.makeRaw(Spacebars.mustache(view.lookup(\"icon\"), \"close\"));\n    })), \"\\n      \"), \"\\n    \" ];\n  }), \"\\n  \");\n}));\n","var confirmSubscription = function () {\n  $('.newsletter-banner form').css('opacity', 0);\n  $('.newsletter-banner .newsletter-subscribed').css('display', 'block').css('opacity', 1);\n  Meteor.setInterval(function () {\n    // required because otherwise banner disappears immediately after confirmation\n    dismissBanner();\n  }, 2000);\n};\n\nvar dismissBanner = function () {\n  $('.newsletter-banner').fadeOut('fast', function () {\n    if(Meteor.user()){\n      // if user is connected, change setting in their account\n      Users.setSetting(Meteor.user(), 'newsletter.showBanner', false);\n    }else{\n      // set cookie\n      Cookie.set('showBanner', \"no\");\n    }\n  });\n};\n\nMeteor.startup(function () {\n  Template.newsletter_banner.helpers({\n    siteName: function () {\n      return Settings.get('title');\n    },\n    isNotConnected: function () {\n      return !Meteor.user();\n    },\n    showBanner: function () {\n      // note: should not be reactive\n      if(\n            Settings.get('showBanner', false) === false\n        ||  !Users.can.view(Meteor.user())\n        ||  Cookie.get('showBanner') === \"no\"\n        ||  (Meteor.user() && Meteor.user().getSetting('newsletter.showBanner', true) === false)\n        ||  (Meteor.user() && Meteor.user().getSetting('newsletter.subscribeToNewsletter', false) === true)\n      ){\n        return false;\n      }else{\n        return true;\n      }\n    }\n  });\n\n  Template.newsletter_banner.events({\n    'click .newsletter-button': function (e) {\n      e.preventDefault();\n      var $banner = $('.newsletter-banner');\n      if(Meteor.user()){\n        $banner.addClass('show-loader');\n        Meteor.call('addCurrentUserToMailChimpList', function (error, result) {\n          $banner.removeClass('show-loader');\n          if(error){\n            console.log(error);\n            Messages.flash(error.message, \"error\");\n          }else{\n            console.log(result);\n            confirmSubscription();\n          }\n        });\n      }else{\n        var email = $('.newsletter-email').val();\n        if(!email){\n          alert('Please fill in your email.');\n          return;\n        }\n        $banner.addClass('show-loader');\n        Meteor.call('addEmailToMailChimpList', email, function (error, result) {\n          $banner.removeClass('show-loader');\n          if(error){\n            console.log(error);\n            Messages.flash(error.reason, \"error\");\n          }else{\n            Messages.clearSeen();\n            console.log(result);\n            confirmSubscription();\n          }\n        });\n      }\n      // $('body').addClass('showing-lightbox');\n      // $(e.target).parents('.post').find('.post-video-lightbox').fadeIn('fast');\n    },\n    'click .newsletter-dismiss': function (e) {\n      $('.newsletter-banner').fadeOut('fast');\n      dismissBanner();\n      e.preventDefault();\n    }\n  });\n});\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\nvar package_templates = _.difference(_.keys(Template), non_package_templates);\n\nfor (var i = 0; i < package_templates.length; i++) {\n  var package_template = package_templates[i];\n\n  registerI18nTemplate(package_template);\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n// integrate the fallback language translations \ntranslations = {};\ntranslations[namespace] = {\"receive_the_best_of\":\"Receive the best of\",\"right_in_your_inbox\":\"right in your inbox.\",\"get_newsletter\":\"Get Newsletter\",\"thanks_for_subscribing\":\"Thanks for subscribing!\",\"newsletter\":\"newsletter\",\"showBanner\":\"Show Banner\",\"mailChimpAPIKey\":\"MailChimp API Key\",\"mailChimpListId\":\"MailChimp List ID\",\"postsPerNewsletter\":\"Posts per Newsletter\",\"newsletterFrequency\":\"Newsletter Frequency\",\"newsletterTime\":\"Newsletter Time\",\"enableNewsletter\":\"Enable Newsletter\",\"autoSubscribe\":\"Auto Subscribe\"};\nTAPi18n._loadLangFileObject(\"en\", translations);\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n","var _ = Package.underscore._,\n    package_name = \"telescope:newsletter\",\n    namespace = \"telescope:newsletter\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n"]}